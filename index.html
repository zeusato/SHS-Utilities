<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:image" content="https://zeusato.github.io/Z-Utilities/Source/Thumb.png">
    <link rel="icon" href="Source/LOGO.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Office Utilities - Tiện ích Văn phòng</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: #FFFFFF;
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .logo img {
            height: 40px;
            width: auto;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: #32336e;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
            height: 100%;
        }

        .nav-menu a:hover {
            color: #10a37f;
        }

        /* Dropdown Menu */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 380px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            border-radius: 12px;
            z-index: 1000;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            padding: 0.5rem 0;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .dropdown-content.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .dropdown-content a {
            color: #333;
            padding: 12px 20px;
            text-decoration: none;
            display: block;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 0 0.5rem;
        }

        .dropdown-content a:hover {
            background-color: #f0f8f5;
            color: #10a37f;
        }

        /* Dropdown hover behavior will be handled by JavaScript */

        .dropdown > a::after {
            content: " ▼";
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        /* Banner */
        .banner {
            background: url('Source/Banner.png') center center / cover no-repeat;
            color: white;
            padding: 1.5rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1;
        }

        .banner-content {
            position: relative;
            z-index: 2;
        }

        .banner-content {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .greeting {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-align: center;
        }

        .name-input {
            font-size: 2.5rem;
            font-weight: 700;
            background: transparent;
            border: none;
            color: white;
            text-align: center;
            width: 300px;
            outline: none;
            border-bottom: 3px solid rgba(255,255,255,0.5);
            transition: border-color 0.3s ease;
        }

        .name-input:focus {
            border-bottom-color: white;
        }

        .name-display {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .edit-icon {
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .edit-icon:hover {
            opacity: 1;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .info-card {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .info-card h3 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .info-card p {
            font-size: 1.2rem;
            font-weight: 600;
            line-height: 1.4;
        }

        .weather-location {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 0.2rem;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            color: white;
            margin-bottom: 3rem;
            font-weight: 700;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .feature-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .feature-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
        }

        .feature-description {
            color: #666;
            line-height: 1.6;
        }

        /* Footer */
        .footer {
            background: rgba(0,0,0,0.1);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .greeting, .name-input, .name-display {
                font-size: 1.8rem;
            }

            .banner {
                padding: 1.2rem 1rem;
            }

            .banner > div {
                flex-direction: column !important;
                gap: 1rem !important;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .nav-menu {
                display: none;
            }

            .dropdown-content {
                min-width: 320px;
                right: -50px;
            }
        }

        @media (max-width: 480px) {
            .logo-text {
                font-size: 1.2rem;
            }

            .header {
                padding: 0.8rem 1rem;
            }

            .dropdown-content {
                min-width: 280px;
                right: -80px;
            }

            .greeting, .name-input, .name-display {
                font-size: 1.5rem;
            }

            .banner {
                padding: 1rem;
            }

            .banner > div {
                flex-direction: column !important;
                gap: 1rem !important;
            }
        }

        /* Styles for Translation Popup */
        #open-translate-popup-btn {
            font-weight: 500;
            color: #333;
            transition: color 0.3s ease;
            cursor: pointer;
        }
        #open-translate-popup-btn:hover {
            color: #10a37f;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .popup-content {
            background-color: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 750px;
            position: relative;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }
        .modal-overlay.active .popup-content {
            transform: scale(1);
        }
        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        .popup-header h2 {
            margin: 0;
            font-size: 22px;
            color: #0056b3;
        }
        .close-btn {
            font-size: 30px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            border: none;
            background: none;
            transition: color 0.2s;
        }
        .close-btn:hover {
            color: #333;
        }
        .translation-container {
            display: grid;
            grid-template-columns: 1fr 40px 1fr;
            gap: 15px;
            align-items: center;
        }
        .language-col textarea {
            width: 100%;
            height: 180px;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            resize: vertical;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .language-col textarea:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }
        .language-col select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            font-size: 15px;
            background-color: #f8f9fa;
        }
        .swap-icon {
            text-align: center;
            font-size: 24px;
            color: #007bff;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .swap-icon:hover {
            transform: rotate(180deg);
        }
        .popup-footer {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
        }
        .action-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        #translate-btn {
            background-color: #28a745;
            color: white;
        }
        #translate-btn:hover {
            background-color: #218838;
        }
        #translate-btn:disabled {
            background-color: #94d3a2;
            cursor: not-allowed;
        }
        #copy-btn {
            background-color: #6c757d;
            color: white;
        }
        #copy-btn:hover {
            background-color: #5a6268;
        }
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 12px 22px;
            border-radius: 8px;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            pointer-events: none;
        }
        .notification.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -10px);
        }
        .popup-container {
            width: 90vw; /* Chiếm 90% chiều rộng viewport ban đầu */
            max-width: 800px; /* Nhưng không quá 800px trên màn hình lớn */
            height: 90vh; /* Chiếm 90% chiều cao viewport ban đầu */
            max-height: 600px; /* Nhưng không quá 600px trên màn hình lớn */
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000; /* Đảm bảo nổi trên cùng */
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            opacity: 0;
            pointer-events: none; /* Ban đầu không tương tác được */
        }
        .popup-container.open {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1); /* Hiệu ứng phóng to nhẹ */
        }
        .popup-container.closed {
            opacity: 0;
            pointer-events: none;
            transform: translate(-50%, -50%) scale(0.95); /* Hiệu ứng thu nhỏ nhẹ khi đóng */
        }

        /* Backdrop mờ phía sau popup */
        .popup-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 999;
            transition: opacity 0.3s ease-in-out;
            opacity: 1; /* Mặc định hiển thị để che khi loading */
            pointer-events: auto; /* Mặc định có thể tương tác để đóng */
        }
        .popup-backdrop.hidden {
             opacity: 0;
             pointer-events: none;
        }

        /* Ẩn các tab content không được chọn */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        /* Thêm hiệu ứng cho input focus */
        input:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.4); /* ring-blue-500/40 */
            border-color: #3b82f6; /* border-blue-500 */
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <img src="Source/1. Logo.png" alt="Logo">
                <span class="logo-text">Utilities</span>
            </a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#home">Trang chủ</a></li>
                    <li class="dropdown">
                        <a href="#features">Tính năng</a>
                        <div class="dropdown-content" id="dropdown-menu">
                            <a href="pdf-editor.html">📝 PDF Editor</a>
                            <a href="image-to-pdf-scanner.html">📄 Chuyển đổi ảnh thành PDF</a>
                            <a href="excel-cleaner.html">🗑️ Dọn rác file Excel</a>
                            <a href="cccd-generator.html">🖼️ Resize ảnh CCCD/Hộ chiếu</a>
                            <a href="url-shortener.html">🔗 Rút gọn Link</a>
                            <a href="random-spinner.html">🌀 Vòng Quay May Mắn</a>
                            <a href="QR-in.html">💳 Tạo QR nhận tiền</a>
                            <a href="ocr-extract.html">🧩 Trích xuất văn bản từ ảnh</a>
                            <a href="qr-generator.html">🔳 Tạo QR Đa Dụng</a>
                            <a href="extract-video.html">🎥 Tách Hình / Tiếng Từ Video</a>
                            <a href="Color Palette.html">🎨 Tạo Bảng Màu Từ Ảnh</a>
                            <!-- <a href="audio-tools.html">🎧 Ghép / Cắt Âm Thanh</a> -->
                        </div>
                    </li>
                    <li><button id="open-translate-popup-btn" class="action-btn" style="background-color: #007bff; color: white;">Dịch Nhanh</button></li>
                    <li><button id="openConverterBtn" class="action-btn" style="background-color: #007bff; color: white;">Xchange</button></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Banner -->
    <section class="banner" id="home">
        <div class="banner-content">
            <!-- Split banner into two halves -->
            <div style="display: flex; gap: 2rem; align-items: center; max-width: 1000px; margin: 0 auto;">
                <!-- Left side: User greeting -->
                <div style="flex: 1; text-align: left;">
                    <div id="greeting-container">
                        <div id="name-input-container" style="display: none;">
                            <input type="text" id="name-input" class="name-input" placeholder="Bạn tên là gì?" maxlength="20" style="text-align: left; width: 100%; max-width: 300px;">
                        </div>
                        <div id="name-display-container" style="display: none;">
                            <div class="name-display" style="justify-content: flex-start;">
                                <span id="name-display-text"></span>
                                <span class="edit-icon" id="edit-name">✏️</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right side: Weather -->
                <div style="flex: 1;">
                    <div class="info-card" style="margin: 0; background: rgba(255,255,255,0.15); backdrop-filter: blur(15px);">
                        <h3 style="margin-bottom: 0.8rem;">🌤️ Thời tiết <span id="weather-location" class="weather-location"></span></h3>
                        <div style="display: flex; gap: 1rem;">
                            <!-- Left side: Today's weather -->
                            <div style="flex: 1; text-align: center;">
                                <div style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.3rem; opacity: 0.8;">
                                    Hôm nay <span id="current-date-inline" style="font-size: 0.75rem; opacity: 0.7;"></span>
                                </div>
                                <div id="weather-info" style="font-size: 1rem; font-weight: 600;">Đang tải...</div>
                            </div>
                            
                            <!-- Right side: Daily forecast -->
                            <div style="flex: 1; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 1rem;">
                                <div style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.3rem; opacity: 0.8;">Daily Forecast</div>
                                <div id="forecast-content" style="font-size: 0.75rem;">Đang tải dự báo...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <h2 class="section-title">🚀 Các tính năng của chúng tôi</h2>
        
        <div class="features-grid">
            <a href="pdf-editor.html" class="feature-card">
                <div class="feature-icon">📝</div>
                <h3 class="feature-title">PDF Editor</h3>
                <p class="feature-description">
                    Chỉnh sửa file PDF và ảnh trực quan. Hỗ trợ crop, xoay, sắp xếp trang,
                    chèn thêm trang và xuất PDF với nhiều tùy chọn nâng cao.
                </p>
            </a>
            
            <a href="image-to-pdf-scanner.html" class="feature-card">
                <div class="feature-icon">📄</div>
                <h3 class="feature-title">Chuyển đổi ảnh thành PDF</h3>
                <p class="feature-description">
                    Chuyển ảnh thường thành file PDF scan chuyên nghiệp. Hỗ trợ batch upload,
                    tự động căn chỉnh và tạo PDF với giao diện như máy scan thật.
                </p>
            </a>
            
            <a href="excel-cleaner.html" class="feature-card">
                <div class="feature-icon">🗑️</div>
                <h3 class="feature-title">Dọn rác file Excel</h3>
                <p class="feature-description">
                    Làm sạch file Excel có dung lượng lớn bất thường. Tự động loại bỏ dữ liệu thừa,
                    named ranges lỗi thời, broken links và xuất file tối ưu.
                </p>
            </a>
            
            <a href="cccd-generator.html" class="feature-card">
                <div class="feature-icon">🖼️</div>
                <h3 class="feature-title">Resize ảnh CCCD/Hộ chiếu</h3>
                <p class="feature-description">
                    Tạo ảnh CCCD chuẩn từ ảnh chân dung thường. Tự động căn chỉnh khuôn mặt,
                    đổi nền và xuất ảnh đúng kích thước theo tiêu chuẩn.
                </p>
            </a>
            
            <a href="url-shortener.html" class="feature-card">
                <div class="feature-icon">🔗</div>
                <h3 class="feature-title">Rút gọn Link</h3>
                <p class="feature-description">
                    Cho phép người dùng nhập một URL bất kỳ và nhận lại phiên bản rút gọn thông qua API của shrtco.de.
                    Hỗ trợ thao tác sao chép nhanh và hiển thị thông báo xác nhận.
                </p>
            </a>

            <a href="random-spinner.html" class="feature-card">
                <div class="feature-icon">🌀</div>
                <h3 class="feature-title">Vòng Quay May Mắn</h3>
                <p class="feature-description">
                    Tạo vòng quay may mắn từ danh sách hoặc quay số ngẫu nhiên trong một khoảng nhất định.
                </p>
            </a>
            
            <a href="QR-in.html" class="feature-card">
                <div class="feature-icon">💳</div>
                <h3 class="feature-title">Tạo QR nhận tiền</h3>
                <p class="feature-description">
                    Tạo mã QR chuyển khoản nhanh chóng và tiện lợi. Hỗ trợ tất cả các ngân hàng
                    tại Việt Nam với giao diện thân thiện và lưu thông tin tự động.
                </p>
            </a>
            
            <a href="ocr-extract.html" class="feature-card">
                <div class="feature-icon">🧩</div>
                <h3 class="feature-title">Trích xuất văn bản từ ảnh</h3>
                <p class="feature-description">
                    Trích xuất văn bản từ file ảnh hoặc PDF (tối đa 3 trang) sử dụng công nghệ OCR.
                    Hỗ trợ xem trước, sắp xếp và xuất ra file DOCX.
                </p>
            </a>
            <a href="qr-generator.html" class="feature-card">
                <div class="feature-icon">🔳</div>
                <h3 class="feature-title">Tạo QR Đa Dụng</h3>
                <p class="feature-description">
                    Tạo mã QR cho link, Vcard, Wi-Fi với nhiều tùy chọn tùy chỉnh màu sắc, logo và style.
                </p>
            </a>
            <a href="extract-video.html" class="feature-card">
                <div class="feature-icon">🎥</div>
                <h3 class="feature-title">Tách Hình / Tiếng Từ Video</h3>
                <p class="feature-description">
                    Tách audio và video từ file video. Xuất ra file MP3 hoặc video không có âm thanh.
                </p>
            </a>
            <a href="Color Palette.html" class="feature-card">
                <div class="feature-icon">🎨</div>
                <h3 class="feature-title">Tạo Bảng Màu Từ Ảnh</h3>
                <p class="feature-description">
                    Tải ảnh lên, chọn một màu và khám phá các bảng màu tuyệt đẹp được tạo từ ảnh của bạn.
                </p>
            </a>
            <!-- <a href="audio-tools.html" class="feature-card">
                <div class="feature-icon">🎧</div>
                <h3 class="feature-title">Ghép / Cắt Âm Thanh</h3>
                <p class="feature-description">
                    Ghép nhiều file audio thành một hoặc cắt một đoạn âm thanh từ file.
                </p>
            </a> -->
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 Zeusato Utilities. Bản quyền thuộc về Nguyễn Mạnh Quyết.</p>
    </footer>

    <!-- Translation Popup HTML -->
    <div id="translate-modal" class="modal-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h2>Công cụ dịch thuật</h2>
                <button id="close-popup-btn" class="close-btn">&times;</button>
            </div>
            <div class="translation-container">
                <div class="language-col">
                    <select id="source-lang">
                        <option value="auto">Tự động phát hiện</option>
                        <option value="vi">Tiếng Việt</option>
                        <option value="en">Tiếng Anh</option>
                        <option value="ja">Tiếng Nhật</option>
                        <option value="ko">Tiếng Hàn</option>
                        <option value="zh">Tiếng Trung</option>
                    </select>
                    <textarea id="source-text" placeholder="Gõ hoặc dán văn bản cần dịch..."></textarea>
                </div>
                <div class="swap-icon" title="Đảo ngược ngôn ngữ">&#8646;</div>
                <div class="language-col">
                    <select id="target-lang">
                        <option value="en">Tiếng Anh</option>
                        <option value="vi">Tiếng Việt</option>
                        <option value="ja">Tiếng Nhật</option>
                        <option value="ko">Tiếng Hàn</option>
                        <option value="zh">Tiếng Trung</option>
                    </select>
                    <textarea id="translated-text" placeholder="Kết quả sẽ ở đây..." readonly></textarea>
                </div>
            </div>
            <div class="popup-footer">
                <button id="copy-btn" class="action-btn">Copy kết quả</button>
                <button id="translate-btn" class="action-btn">Dịch</button>
            </div>
        </div>
    </div>
    <div id="notification" class="notification"></div>
    <!-- Backdrop -->
    <div id="popupBackdrop" class="popup-backdrop flex items-center justify-center hidden">
    <div id="initialLoading" class="text-white text-lg flex items-center">
        <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Đang tải dữ liệu, đại ca chờ xíu nhé...
    </div>
    </div>

    <!-- Popup -->
    <div id="converterPopup" class="popup-container bg-white rounded-xl shadow-2xl flex flex-col overflow-hidden closed">
    <div class="p-4 bg-gray-100 flex justify-between items-center border-b border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800">Bộ Chuyển Đổi Đơn Vị</h2>
        <button id="closePopupBtn" class="text-gray-500 hover:text-gray-800 text-3xl font-semibold leading-none">&times;</button>
    </div>

    <!-- Tabs -->
    <div class="flex border-b border-gray-200 bg-gray-50">
        <button class="tab-button active flex-1 py-3 px-4 text-center text-gray-700 font-medium border-b-2 border-blue-600" data-tab="currency">Tiền Tệ</button>
        <button class="tab-button flex-1 py-3 px-4 text-center text-gray-700 font-medium border-b-2 border-transparent" data-tab="weight">Cân Nặng</button>
        <button class="tab-button flex-1 py-3 px-4 text-center text-gray-700 font-medium border-b-2 border-transparent" data-tab="length">Chiều Dài</button>
        <button class="tab-button flex-1 py-3 px-4 text-center text-gray-700 font-medium border-b-2 border-transparent" data-tab="temperature">Nhiệt Độ</button>
        <button class="tab-button flex-1 py-3 px-4 text-center text-gray-700 font-medium border-b-2 border-transparent" data-tab="area">Diện Tích</button>
    </div>

    <!-- Content (giữ nguyên từ file của đại ca) -->
    <!-- === COPY NGUYÊN KHỐI NỘI DUNG CÁC TAB TỪ FILE CỦA ĐẠI CA VÀO ĐÂY (từ <div class="flex-grow ..."> tới </div>) === -->
     <div class="flex-grow p-6 overflow-y-auto">
            <!-- Tab Tiền Tệ -->
            <div id="currency" class="tab-content active space-y-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Chuyển Đổi Tiền Tệ</h3>
                <div class="flex items-center space-x-3">
                    <input
                    id="currencyInput"
                    type="text"
                    inputmode="decimal"
                    autocomplete="off"
                    placeholder="Nhập số tiền"
                    class="flex-grow shadow-sm appearance-none border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500"
                    aria-describedby="currencyHelp"
                    pattern="^\d{1,3}([\. ]\d{3})*(,\d+)?$"
                    />
                    <input id="currencyRaw" type="hidden" name="amount" />
                    <small id="currencyHelp" class="text-gray-500">
                    Chỉ nhập số, dùng dấu <b>,</b> cho thập phân<br> (VD: 12.345,67)
                    </small>
                    <select id="currencyFrom" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="USD">USD</option>
                        <option value="VND">VND</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="CAD">CAD</option>
                        <option value="AUD">AUD</option>
                        <option value="CHF">CHF</option>
                        <option value="CNY">CNY</option>
                    </select>
                    <div class="swap-icon" title="Đảo ngược đơn vị">&#8646;</div>
                    <select id="currencyTo" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="VND">VND</option>
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="CAD">CAD</option>
                        <option value="AUD">AUD</option>
                        <option value="CHF">CHF</option>
                        <option value="CNY">CNY</option>
                    </select>
                </div>
                <button id="convertCurrencyBtn" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-5 rounded-lg w-full transition duration-200 ease-in-out transform hover:scale-105 active:scale-95 shadow-md flex items-center justify-center">
                    <span id="currencyBtnText">Chuyển Đổi</span>
                    <svg id="currencySpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </button>
                <div class="mt-5 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between">
                    <p class="text-blue-800 font-medium">Kết quả: <span id="currencyResult" class="font-bold text-lg">0 USD</span></p>
                    <button class="copy-result-btn bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1.5 px-3 rounded-md transition duration-200 ease-in-out" data-target="currencyResult">Sao Chép</button>
                </div>
                <p class="text-sm text-gray-500 mt-2">Tỷ giá được cung cấp bởi <a href="https://www.exchangerate-api.com" class="text-blue-600 hover:underline" target="_blank">ExchangeRate-API.com</a>.</p>
            </div>

            <!-- Tab Cân Nặng -->
            <div id="weight" class="tab-content space-y-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Chuyển Đổi Cân Nặng (Pound sang Kilogram mặc định)</h3>
                <div class="flex items-center space-x-3">
                    <input type="number" id="weightInput" placeholder="Nhập cân nặng" class="flex-grow shadow-sm appearance-none border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <select id="weightFrom" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="lbs">Pound (lbs)</option>
                        <option value="kg">Kilogram (kg)</option>
                        <option value="g">Gram (g)</option>
                    </select>
                    <div class="swap-icon" title="Đảo ngược đơn vị">&#8646;</div>
                    <select id="weightTo" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="kg">Kilogram (kg)</option>
                        <option value="lbs">Pound (lbs)</option>
                        <option value="g">Gram (g)</option>
                    </select>
                </div>
                <button id="convertWeightBtn" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-5 rounded-lg w-full transition duration-200 ease-in-out transform hover:scale-105 active:scale-95 shadow-md">
                    Chuyển Đổi
                </button>
                <div class="mt-5 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between">
                    <p class="text-blue-800 font-medium">Kết quả: <span id="weightResult" class="font-bold text-lg">0 kg</span></p>
                    <button class="copy-result-btn bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1.5 px-3 rounded-md transition duration-200 ease-in-out" data-target="weightResult">Sao Chép</button>
                </div>
            </div>

            <!-- Tab Chiều Dài -->
            <div id="length" class="tab-content space-y-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Chuyển Đổi Chiều Dài (Inch sang Centimeter mặc định)</h3>
                <div class="flex items-center space-x-3">
                    <input type="number" id="lengthInput" placeholder="Nhập chiều dài" class="flex-grow shadow-sm appearance-none border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <select id="lengthFrom" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="inch">Inch</option>
                        <option value="cm">Centimeter (cm)</option>
                        <option value="m">Meter (m)</option>
                        <option value="km">Kilometer (km)</option>
                        <option value="ft">Feet (ft)</option>
                        <option value="yd">Yard (yd)</option>
                        <option value="mi">Mile (mi)</option>
                    </select>
                    <div class="swap-icon" title="Đảo ngược đơn vị">&#8646;</div>
                    <select id="lengthTo" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="cm">Centimeter (cm)</option>
                        <option value="inch">Inch</option>
                        <option value="m">Meter (m)</option>
                        <option value="km">Kilometer (km)</option>
                        <option value="ft">Feet (ft)</option>
                        <option value="yd">Yard (yd)</option>
                        <option value="mi">Mile (mi)</option>
                    </select>
                </div>
                <button id="convertLengthBtn" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-5 rounded-lg w-full transition duration-200 ease-in-out transform hover:scale-105 active:scale-95 shadow-md">
                    Chuyển Đổi
                </button>
                <div class="mt-5 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between">
                    <p class="text-blue-800 font-medium">Kết quả: <span id="lengthResult" class="font-bold text-lg">0 cm</span></p>
                    <button class="copy-result-btn bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1.5 px-3 rounded-md transition duration-200 ease-in-out" data-target="lengthResult">Sao Chép</button>
                </div>
            </div>

            <!-- Tab Nhiệt Độ -->
            <div id="temperature" class="tab-content space-y-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Chuyển Đổi Nhiệt Độ (Fahrenheit sang Celsius mặc định)</h3>
                <div class="flex items-center space-x-3">
                    <input type="number" id="temperatureInput" placeholder="Nhập nhiệt độ" class="flex-grow shadow-sm appearance-none border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <select id="temperatureFrom" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="F">Fahrenheit (°F)</option>
                        <option value="C">Celsius (°C)</option>
                        <option value="K">Kelvin (K)</option>
                    </select>
                    <div class="swap-icon" title="Đảo ngược đơn vị">&#8646;</div>
                    <select id="temperatureTo" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="C">Celsius (°C)</option>
                        <option value="F">Fahrenheit (°F)</option>
                        <option value="K">Kelvin (K)</option>
                    </select>
                </div>
                <button id="convertTemperatureBtn" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-5 rounded-lg w-full transition duration-200 ease-in-out transform hover:scale-105 active:scale-95 shadow-md">
                    Chuyển Đổi
                </button>
                <div class="mt-5 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between">
                    <p class="text-blue-800 font-medium">Kết quả: <span id="temperatureResult" class="font-bold text-lg">0 °C</span></p>
                    <button class="copy-result-btn bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1.5 px-3 rounded-md transition duration-200 ease-in-out" data-target="temperatureResult">Sao Chép</button>
                </div>
            </div>

            <!-- Tab Diện Tích -->
            <div id="area" class="tab-content space-y-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Chuyển Đổi Diện Tích (Mét vuông sang Feet vuông mặc định)</h3>
                <div class="flex items-center space-x-3">
                    <input type="number" id="areaInput" placeholder="Nhập diện tích" class="flex-grow shadow-sm appearance-none border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <select id="areaFrom" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="sqm">Mét vuông (m²)</option>
                        <option value="sqft">Feet vuông (ft²)</option>
                        <option value="sqkm">Kilomet vuông (km²)</option>
                        <option value="acre">Acre</option>
                        <option value="ha">Hecta (ha)</option>
                    </select>
                    <div class="swap-icon" title="Đảo ngược đơn vị">&#8646;</div>
                    <select id="areaTo" class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="sqft">Feet vuông (ft²)</option>
                        <option value="sqm">Mét vuông (m²)</option>
                        <option value="sqkm">Kilomet vuông (km²)</option>
                        <option value="acre">Acre</option>
                        <option value="ha">Hecta (ha)</option>
                    </select>
                </div>
                <button id="convertAreaBtn" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-5 rounded-lg w-full transition duration-200 ease-in-out transform hover:scale-105 active:scale-95 shadow-md">
                    Chuyển Đổi
                </button>
                <div class="mt-5 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between">
                    <p class="text-blue-800 font-medium">Kết quả: <span id="areaResult" class="font-bold text-lg">0 ft²</span></p>
                    <button class="copy-result-btn bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1.5 px-3 rounded-md transition duration-200 ease-in-out" data-target="areaResult">Sao Chép</button>
                </div>
            </div>
        </div>
    <!-- BẮT BUỘC giữ nguyên id của các input/select/button/result để JS bắt được -->
    </div>

    <script>
        // Lấy tên từ localStorage
        let userName = localStorage.getItem('userName');
        
        // Elements
        const nameInputContainer = document.getElementById('name-input-container');
        const nameDisplayContainer = document.getElementById('name-display-container');
        const nameInput = document.getElementById('name-input');
        const nameDisplayText = document.getElementById('name-display-text');
        const editNameBtn = document.getElementById('edit-name');
        
        // Hiển thị greeting
        function showGreeting() {
            if (userName) {
                nameDisplayText.textContent = `Xin chào ${userName}`;
                nameDisplayContainer.style.display = 'flex';
                nameInputContainer.style.display = 'none';
            } else {
                nameInputContainer.style.display = 'block';
                nameDisplayContainer.style.display = 'none';
            }
        }
        
        // Lưu tên
        function saveName() {
            const name = nameInput.value.trim();
            if (name) {
                // Viết hoa tất cả các chữ cái đầu từ
                const formattedName = name.split(' ').map(word => 
                    word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
                ).join(' ');
                localStorage.setItem('userName', formattedName);
                userName = formattedName;
                showGreeting();
            }
        }
        
        // Event listeners
        nameInput.addEventListener('blur', saveName);
        nameInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                saveName();
            }
        });
        
        editNameBtn.addEventListener('click', function() {
            nameInput.value = userName;
            nameInputContainer.style.display = 'block';
            nameDisplayContainer.style.display = 'none';
            nameInput.focus();
        });
        
        // Hiển thị ngày tháng inline
        function updateDateTime() {
            const now = new Date();
            const options = {
                day: 'numeric',
                month: 'numeric'
            };
            const dateStr = now.toLocaleDateString('vi-VN', options);
            const inlineDateElement = document.getElementById('current-date-inline');
            if (inlineDateElement) {
                inlineDateElement.textContent = `(${dateStr})`;
            }
        }
        
        // Lấy thông tin thời tiết với One Call API
        async function getWeather() {
            try {
                if (!navigator.geolocation) {
                    document.getElementById('weather-info').textContent = 'Trình duyệt không hỗ trợ định vị';
                    document.getElementById('forecast-content').textContent = 'Trình duyệt không hỗ trợ định vị';
                    return;
                }

                // Kiểm tra permission state từ localStorage
                const locationPermission = localStorage.getItem('locationPermission');
                const savedLocation = localStorage.getItem('savedLocation');
                
                // Nếu đã từ chối permission trước đó, không hỏi lại
                if (locationPermission === 'denied') {
                    document.getElementById('weather-info').textContent = 'Quyền truy cập vị trí đã bị từ chối';
                    document.getElementById('forecast-content').textContent = 'Không thể lấy dự báo thời tiết';
                    return;
                }
                
                // Nếu có vị trí đã lưu và chưa quá 30 phút, sử dụng luôn
                if (savedLocation && locationPermission === 'granted') {
                    const locationData = JSON.parse(savedLocation);
                    const now = Date.now();
                    const locationAge = now - locationData.timestamp;
                    
                    // Sử dụng vị trí đã lưu nếu chưa quá 30 phút (1800000 ms)
                    if (locationAge < 1800000) {
                        console.log('Sử dụng vị trí đã lưu:', locationData);
                        await fetchWeatherData(locationData.latitude, locationData.longitude);
                        return;
                    }
                }

                // Kiểm tra permission hiện tại trước khi request
                if (navigator.permissions) {
                    try {
                        const permission = await navigator.permissions.query({name: 'geolocation'});
                        console.log('Current permission state:', permission.state);
                        
                        if (permission.state === 'denied') {
                            localStorage.setItem('locationPermission', 'denied');
                            document.getElementById('weather-info').textContent = 'Quyền truy cập vị trí đã bị từ chối';
                            document.getElementById('forecast-content').textContent = 'Không thể lấy dự báo thời tiết';
                            return;
                        }
                        
                        if (permission.state === 'granted') {
                            localStorage.setItem('locationPermission', 'granted');
                        }
                    } catch (permError) {
                        console.log('Permission API không khả dụng:', permError);
                    }
                }

                // Request location
                navigator.geolocation.getCurrentPosition(
                    async function(position) {
                        const { latitude, longitude } = position.coords;
                        
                        // Lưu permission state và vị trí
                        localStorage.setItem('locationPermission', 'granted');
                        localStorage.setItem('savedLocation', JSON.stringify({
                            latitude,
                            longitude,
                            timestamp: Date.now()
                        }));
                        
                        console.log('Vị trí mới được lấy và lưu:', { latitude, longitude });
                        await fetchWeatherData(latitude, longitude);
                    },
                    function(error) {
                        console.error('Geolocation error:', error);
                        
                        // Lưu trạng thái từ chối permission
                        if (error.code === error.PERMISSION_DENIED) {
                            localStorage.setItem('locationPermission', 'denied');
                            document.getElementById('weather-info').textContent = 'Quyền truy cập vị trí đã bị từ chối';
                            document.getElementById('forecast-content').textContent = 'Không thể lấy dự báo thời tiết';
                        } else {
                            document.getElementById('weather-info').textContent = 'Không thể lấy vị trí - ' + error.message;
                            document.getElementById('forecast-content').textContent = 'Không thể lấy vị trí';
                        }
                    },
                    {
                        timeout: 10000,
                        enableHighAccuracy: false,
                        maximumAge: 300000 // 5 phút
                    }
                );
            } catch (error) {
                console.error('Weather function error:', error);
                document.getElementById('weather-info').textContent = 'Không thể tải thời tiết - ' + error.message;
                document.getElementById('forecast-content').textContent = 'Lỗi tải dự báo';
            }
        }
        
        // Tách riêng function fetch weather data
        async function fetchWeatherData(latitude, longitude) {
            try {
                // Sử dụng OpenWeatherMap One Call API
                const apiKey = '56c6e90bfff82043ae93482cab965c0f';
                
                // Gọi cả current weather và One Call API
                const currentWeatherUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=vi`;
                const oneCallUrl = `https://api.openweathermap.org/data/3.0/onecall?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=vi&exclude=minutely,alerts`;
                
                console.log('Đang gọi Current Weather API:', currentWeatherUrl);
                console.log('Đang gọi One Call API:', oneCallUrl);
                
                // Gọi current weather API
                const currentResponse = await fetch(currentWeatherUrl);
                console.log('Current weather response status:', currentResponse.status);
                
                if (currentResponse.ok) {
                    const currentData = await currentResponse.json();
                    console.log('Current weather data:', currentData);
                    
                    if (currentData.main && currentData.weather && currentData.weather[0]) {
                        const temp = Math.round(currentData.main.temp);
                        const description = currentData.weather[0].description;
                        const location = currentData.name || 'Vị trí hiện tại';
                        
                        // Cập nhật địa điểm
                        document.getElementById('weather-location').textContent = `(${location})`;
                        
                        // Cập nhật thông tin thời tiết hiện tại
                        document.getElementById('weather-info').innerHTML = `
                            <div>${temp}°C - ${description}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.2rem;">Nhiệt độ cảm nhận: ${Math.round(currentData.main.feels_like)}°C</div>
                        `;
                    }
                }
                
                // Gọi One Call API cho daily forecast
                try {
                    const oneCallResponse = await fetch(oneCallUrl);
                    console.log('One Call response status:', oneCallResponse.status);
                    
                    if (oneCallResponse.ok) {
                        const oneCallData = await oneCallResponse.json();
                        console.log('One Call data:', oneCallData);
                        
                        if (oneCallData.daily && oneCallData.daily.length > 0) {
                            displayDailyForecast(oneCallData.daily.slice(0, 3)); // Hiển thị 3 ngày đầu
                        } else {
                            document.getElementById('forecast-content').textContent = 'Không có dữ liệu dự báo';
                        }
                    } else {
                        console.error('One Call API Error:', oneCallResponse.status);
                        // Fallback: sử dụng 5-day forecast API miễn phí
                        await getFiveDayForecast(latitude, longitude, apiKey);
                    }
                } catch (oneCallError) {
                    console.error('One Call API Error:', oneCallError);
                    // Fallback: sử dụng 5-day forecast API miễn phí
                    await getFiveDayForecast(latitude, longitude, apiKey);
                }
            } catch (error) {
                console.error('Fetch weather data error:', error);
                document.getElementById('weather-info').textContent = 'Lỗi tải thời tiết - ' + error.message;
                document.getElementById('forecast-content').textContent = 'Lỗi tải dự báo';
            }
        }
        
        // Fallback: Sử dụng 5-day forecast API (miễn phí)
        async function getFiveDayForecast(latitude, longitude, apiKey) {
            try {
                const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=vi`;
                console.log('Đang gọi 5-day Forecast API:', forecastUrl);
                
                const response = await fetch(forecastUrl);
                console.log('5-day forecast response status:', response.status);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('5-day forecast data:', data);
                    
                    if (data.list && data.list.length > 0) {
                        // Lấy dự báo cho 3 ngày (mỗi ngày lấy forecast lúc 12:00)
                        const dailyForecasts = [];
                        const processedDates = new Set();
                        
                        for (const item of data.list) {
                            const date = new Date(item.dt * 1000);
                            const dateStr = date.toDateString();
                            
                            if (!processedDates.has(dateStr) && dailyForecasts.length < 3) {
                                dailyForecasts.push({
                                    dt: item.dt,
                                    temp: {
                                        min: item.main.temp_min,
                                        max: item.main.temp_max
                                    },
                                    weather: item.weather,
                                    clouds: item.clouds,
                                    pop: item.pop, // Probability of precipitation
                                    humidity: item.main.humidity
                                });
                                processedDates.add(dateStr);
                            }
                        }
                        
                        displayDailyForecastFallback(dailyForecasts);
                    } else {
                        document.getElementById('forecast-content').textContent = 'Không có dữ liệu dự báo';
                    }
                } else {
                    console.error('5-day Forecast API Error:', response.status);
                    document.getElementById('forecast-content').textContent = `Lỗi API dự báo: ${response.status}`;
                }
            } catch (error) {
                console.error('5-day Forecast Error:', error);
                document.getElementById('forecast-content').textContent = 'Lỗi tải dự báo';
            }
        }
        
        // Hiển thị daily forecast từ One Call API
        function displayDailyForecast(dailyData) {
            let forecastHtml = '';
            
            for (let i = 0; i < Math.min(3, dailyData.length); i++) {
                const day = dailyData[i];
                const date = new Date(day.dt * 1000);
                const dayName = i === 0 ? 'Hôm nay' : date.toLocaleDateString('vi-VN', { weekday: 'short' });
                
                const tempMin = Math.round(day.temp.min);
                const tempMax = Math.round(day.temp.max);
                const description = day.weather[0].description;
                const clouds = day.clouds || 0;
                const uvi = day.uvi || 0;
                const pop = Math.round((day.pop || 0) * 100); // Probability of precipitation
                
                forecastHtml += `
                    <div style="margin-bottom: 0.4rem; padding: 0.2rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-weight: 500; font-size: 0.85rem;">${dayName}</div>
                        <div style="font-size: 0.75rem; margin-top: 0.1rem;">
                            ${tempMin}°/${tempMax}°C, ${description}
                        </div>
                        <div style="font-size: 0.7rem; opacity: 0.7; margin-top: 0.1rem;">
                            ☁️${clouds}% | ☀️${uvi.toFixed(1)} | 🌧️${pop}%
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('forecast-content').innerHTML = forecastHtml;
        }
        
        // Hiển thị daily forecast từ 5-day API (fallback)
        function displayDailyForecastFallback(dailyData) {
            let forecastHtml = '';
            
            for (let i = 0; i < Math.min(3, dailyData.length); i++) {
                const day = dailyData[i];
                const date = new Date(day.dt * 1000);
                const dayName = i === 0 ? 'Hôm nay' : date.toLocaleDateString('vi-VN', { weekday: 'short' });
                
                const tempMin = Math.round(day.temp.min);
                const tempMax = Math.round(day.temp.max);
                const description = day.weather[0].description;
                const clouds = day.clouds?.all || 0;
                const pop = Math.round((day.pop || 0) * 100);
                const humidity = day.humidity || 0;
                
                forecastHtml += `
                    <div style="margin-bottom: 0.4rem; padding: 0.2rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-weight: 500; font-size: 0.85rem;">${dayName}</div>
                        <div style="font-size: 0.75rem; margin-top: 0.1rem;">
                            ${tempMin}°/${tempMax}°C, ${description}
                        </div>
                        <div style="font-size: 0.7rem; opacity: 0.7; margin-top: 0.1rem;">
                            ☁️${clouds}% | 💧${humidity}% | 🌧️${pop}%
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('forecast-content').innerHTML = forecastHtml;
        }
        
        // Test API key với cả current weather và One Call API
        async function testWeatherAPI() {
            try {
                const apiKey = '56c6e90bfff82043ae93482cab965c0f';
                // Test với tọa độ Hà Nội
                const currentWeatherUrl = `https://api.openweathermap.org/data/2.5/weather?lat=21.0285&lon=105.8542&appid=${apiKey}&units=metric&lang=vi`;
                const oneCallUrl = `https://api.openweathermap.org/data/3.0/onecall?lat=21.0285&lon=105.8542&appid=${apiKey}&units=metric&lang=vi&exclude=minutely,alerts`;
                
                console.log('Testing Current Weather API với Hà Nội:', currentWeatherUrl);
                const currentResponse = await fetch(currentWeatherUrl);
                console.log('Current weather test response status:', currentResponse.status);
                
                console.log('Testing One Call API với Hà Nội:', oneCallUrl);
                const oneCallResponse = await fetch(oneCallUrl);
                console.log('One Call test response status:', oneCallResponse.status);
                
                if (currentResponse.ok) {
                    const currentData = await currentResponse.json();
                    console.log('Test current weather data:', currentData);
                    
                    if (oneCallResponse.ok) {
                        const oneCallData = await oneCallResponse.json();
                        console.log('Test One Call data:', oneCallData);
                        console.log('✅ Cả hai API đều hoạt động');
                        return { current: true, oneCall: true };
                    } else {
                        console.log('⚠️ Current Weather OK, One Call API lỗi:', oneCallResponse.status);
                        return { current: true, oneCall: false };
                    }
                } else {
                    const errorText = await currentResponse.text();
                    console.error('Current Weather API Test Error:', currentResponse.status, errorText);
                    return { current: false, oneCall: false };
                }
            } catch (error) {
                console.error('API Test Error:', error);
                return { current: false, oneCall: false };
            }
        }
        
        // Kiểm tra trạng thái API key
        async function checkAPIKeyStatus() {
            const apiKey = '56c6e90bfff82043ae93482cab965c0f';
            
            // Test với endpoint đơn giản nhất
            const testUrl = `https://api.openweathermap.org/data/2.5/weather?q=London&appid=${apiKey}`;
            
            try {
                console.log('Checking API key status...');
                const response = await fetch(testUrl);
                
                if (response.ok) {
                    console.log('✅ API key hoạt động bình thường');
                    
                    // Test thêm One Call API
                    const testResults = await testWeatherAPI();
                    if (testResults.oneCall) {
                        console.log('✅ One Call API cũng hoạt động');
                        document.getElementById('forecast-content').innerHTML = '<div style="opacity: 0.7;">Sẵn sàng tải dự báo...</div>';
                    } else {
                        console.log('⚠️ One Call API không khả dụng, sẽ dùng 5-day forecast');
                        document.getElementById('forecast-content').innerHTML = '<div style="opacity: 0.7;">Sẽ dùng API dự báo 5 ngày...</div>';
                    }
                    
                    return true;
                } else if (response.status === 401) {
                    console.log('❌ API key không hợp lệ hoặc chưa được kích hoạt');
                    document.getElementById('weather-info').textContent = 'API key chưa được kích hoạt (có thể cần 2-3 giờ)';
                    document.getElementById('forecast-content').textContent = 'API key chưa sẵn sàng';
                    return false;
                } else if (response.status === 429) {
                    console.log('❌ Quá nhiều request');
                    document.getElementById('weather-info').textContent = 'Quá nhiều request, thử lại sau';
                    document.getElementById('forecast-content').textContent = 'Quá nhiều request';
                    return false;
                } else {
                    console.log(`❌ Lỗi API: ${response.status}`);
                    document.getElementById('weather-info').textContent = `Lỗi API: ${response.status}`;
                    document.getElementById('forecast-content').textContent = `Lỗi API: ${response.status}`;
                    return false;
                }
            } catch (error) {
                console.log('❌ Lỗi mạng:', error);
                document.getElementById('weather-info').textContent = 'Lỗi kết nối mạng';
                document.getElementById('forecast-content').textContent = 'Lỗi kết nối mạng';
                return false;
            }
        }
        
        // Khởi tạo
        showGreeting();
        updateDateTime();
        
        // Kiểm tra API key trước
        checkAPIKeyStatus().then(isValid => {
            if (isValid) {
                getWeather();
            }
        });
        

        
        // Cập nhật thời gian mỗi phút
        setInterval(updateDateTime, 60000);

        // Dropdown menu functionality with delay
        let dropdownTimeout;
        const dropdown = document.querySelector('.dropdown');
        const dropdownMenu = document.getElementById('dropdown-menu');

        if (dropdown && dropdownMenu) {
            dropdown.addEventListener('mouseenter', function() {
                clearTimeout(dropdownTimeout);
                dropdownMenu.classList.add('show');
            });

            dropdown.addEventListener('mouseleave', function() {
                dropdownTimeout = setTimeout(function() {
                    dropdownMenu.classList.remove('show');
                }, 800); // 0.8 second delay
            });

            // Keep menu open when hovering over the dropdown content
            dropdownMenu.addEventListener('mouseenter', function() {
                clearTimeout(dropdownTimeout);
            });

            dropdownMenu.addEventListener('mouseleave', function() {
                dropdownTimeout = setTimeout(function() {
                    dropdownMenu.classList.remove('show');
                }, 800);
            });
        }

        // --- Translation Popup Logic ---
        document.addEventListener('DOMContentLoaded', function() {
            const openBtn = document.getElementById('open-translate-popup-btn');
            const closeBtn = document.getElementById('close-popup-btn');
            const modal = document.getElementById('translate-modal');
            const sourceText = document.getElementById('source-text');
            const translatedText = document.getElementById('translated-text');
            const sourceLang = document.getElementById('source-lang');
            const targetLang = document.getElementById('target-lang');
            const translateBtn = document.getElementById('translate-btn');
            const copyBtn = document.getElementById('copy-btn');
            const swapBtn = document.querySelector('.swap-icon');
            const notification = document.getElementById('notification');
            let notificationTimeout;

            const LT_ENDPOINTS = [
                'https://lt.vern.cc',
                'https://translate.terraprint.co',
                'https://libretranslate.com',
            ];

            async function robustTranslate(q, source, target) {
                let lastErr;
                for (const base of LT_ENDPOINTS) {
                    try {
                        const res = await fetch(`${base}/translate`, {
                            method: "POST",
                            body: JSON.stringify({ q, source, target, format: "text" }),
                            headers: { "Content-Type": "application/json" }
                        });

                        if (!res.ok) {
                            let errorMsg = `Lỗi máy chủ ${res.status}`;
                            try {
                                const errorData = await res.json();
                                errorMsg = errorData.error || errorMsg;
                            } catch (e) {}
                            throw new Error(errorMsg);
                        }
                        
                        const data = await res.json();
                        return data;
                    } catch (e) {
                        lastErr = e;
                    }
                }
                throw lastErr ?? new Error('Tất cả các máy chủ dịch đều lỗi.');
            }

            function showNotification(message) {
                if (notificationTimeout) clearTimeout(notificationTimeout);
                notification.textContent = message;
                notification.classList.add('show');
                notificationTimeout = setTimeout(() => {
                    notification.classList.remove('show');
                }, 2500);
            }

            openBtn.addEventListener('click', () => modal.classList.add('active'));

            const closeModal = () => modal.classList.remove('active');

            closeBtn.addEventListener('click', closeModal);
            // modal.addEventListener('click', (event) => {
            //     if (event.target === modal) closeModal();
            // });
            
            swapBtn.addEventListener('click', () => {
                if (sourceLang.value === 'auto') {
                    showNotification('Không hoán đổi được khi đang ở chế độ "Tự động phát hiện"!');
                    return;
                }
                
                const tempLang = sourceLang.value;
                sourceLang.value = targetLang.value;
                targetLang.value = tempLang;

                const tempText = sourceText.value;
                sourceText.value = translatedText.value;
                translatedText.value = tempText;
            });

            translateBtn.addEventListener('click', async () => {
                const text = sourceText.value.trim();
                const fromLang = sourceLang.value;
                const toLang = targetLang.value;

                if (!text) {
                    showNotification("Vui lòng nhập văn bản cần dịch.");
                    return;
                }

                translateBtn.disabled = true;
                translateBtn.textContent = 'Đang dịch...';
                translatedText.value = 'Đang xử lý...';

                try {
                    const data = await robustTranslate(text, fromLang, toLang);
                    translatedText.value = data.translatedText;

                    if (fromLang === 'auto' && data.detectedLanguage?.language) {
                        const detectedLangCode = data.detectedLanguage.language;
                        const optionExists = Array.from(sourceLang.options).some(opt => opt.value === detectedLangCode);
                        if (optionExists) {
                            sourceLang.value = detectedLangCode;
                            showNotification(`Đã phát hiện ngôn ngữ: ${sourceLang.options[sourceLang.selectedIndex].text}`);
                        }
                    }
                } catch (error) {
                    translatedText.value = `Lỗi: ${error.message}`;
                    showNotification('Tất cả các máy chủ dịch đều lỗi, vui lòng thử lại sau.');
                } finally {
                    translateBtn.disabled = false;
                    translateBtn.textContent = 'Dịch';
                }
            });

            copyBtn.addEventListener('click', () => {
                const textToCopy = translatedText.value;
                if (!textToCopy || textToCopy.includes('Đang xử lý')) {
                    showNotification('Không có nội dung để sao chép.');
                    return;
                }

                navigator.clipboard.writeText(textToCopy).then(() => {
                    showNotification('Đã sao chép vào clipboard!');
                }).catch(err => {
                    showNotification('Sao chép thất bại, trình duyệt không hỗ trợ.');
                });
            });
        });
        // ===== Map tới nút sẵn có của đại ca =====
        const openConverterBtn = document.getElementById('openConverterBtn');

        // ===== DOM khác =====
        const converterPopup = document.getElementById('converterPopup');
        const closePopupBtn = document.getElementById('closePopupBtn');
        const popupBackdrop = document.getElementById('popupBackdrop');
        const initialLoading = document.getElementById('initialLoading');
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const copyButtons = document.querySelectorAll('.copy-result-btn');

        // Currency
        const currencyInput = document.getElementById('currencyInput');
        const currencyFrom = document.getElementById('currencyFrom');
        const currencyTo = document.getElementById('currencyTo');
        const convertCurrencyBtn = document.getElementById('convertCurrencyBtn');
        const currencyBtnText = document.getElementById('currencyBtnText');
        const currencySpinner = document.getElementById('currencySpinner');
        const currencyResult = document.getElementById('currencyResult');

        // Weight
        const weightInput = document.getElementById('weightInput');
        const weightFrom = document.getElementById('weightFrom');
        const weightTo = document.getElementById('weightTo');
        const convertWeightBtn = document.getElementById('convertWeightBtn');
        const weightResult = document.getElementById('weightResult');

        // Length
        const lengthInput = document.getElementById('lengthInput');
        const lengthFrom = document.getElementById('lengthFrom');
        const lengthTo = document.getElementById('lengthTo');
        const convertLengthBtn = document.getElementById('convertLengthBtn');
        const lengthResult = document.getElementById('lengthResult');

        // Temp
        const temperatureInput = document.getElementById('temperatureInput');
        const temperatureFrom = document.getElementById('temperatureFrom');
        const temperatureTo = document.getElementById('temperatureTo');
        const convertTemperatureBtn = document.getElementById('convertTemperatureBtn');
        const temperatureResult = document.getElementById('temperatureResult');

        // Area
        const areaInput = document.getElementById('areaInput');
        const areaFrom = document.getElementById('areaFrom');
        const areaTo = document.getElementById('areaTo');
        const convertAreaBtn = document.getElementById('convertAreaBtn');
        const areaResult = document.getElementById('areaResult');

        // Helper
        function showCustomAlert(message){
            const old=document.getElementById('custom-alert'); if(old) old.remove();
            const box=document.createElement('div');
            box.id='custom-alert';
            box.className='fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50';
            box.innerHTML=`<div class="bg-white p-6 rounded-lg shadow-2xl max-w-sm w-full text-center">
            <p class="text-gray-800 text-lg font-medium mb-5">${message}</p>
            <button id="closeAlertBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg">Ok</button>
            </div>`;
            document.body.appendChild(box);
            document.getElementById('closeAlertBtn').onclick=()=>box.remove();
        }

        function openPopup(){
            converterPopup.classList.remove('closed');
            converterPopup.classList.add('open');
            popupBackdrop.classList.remove('hidden');
            document.body.style.overflow='hidden';
        }
        function closePopup(){
            converterPopup.classList.remove('open'); converterPopup.classList.add('closed');
            setTimeout(()=>popupBackdrop.classList.add('hidden'),300);
            document.body.style.overflow='';
        }

        function switchTab(tabId){
            tabButtons.forEach(b=>{
            if(b.dataset.tab===tabId){ b.classList.add('active','border-blue-600'); b.classList.remove('border-transparent'); }
            else { b.classList.remove('active','border-blue-600'); b.classList.add('border-transparent'); }
            });
            tabContents.forEach(c=> c.id===tabId ? c.classList.add('active') : c.classList.remove('active'));
        }

        function copyResult(e){
            const id=e.target.dataset.target, el=document.getElementById(id);
            navigator.clipboard?.writeText(el.textContent).then(()=>{
            e.target.textContent='Đã sao chép!'; setTimeout(()=>e.target.textContent='Sao Chép',1500);
            }).catch(()=>{
            showCustomAlert('Không sao chép được, đại ca copy tay giúp em!');
            });
        }

        function formatConverterResult(value) {
            if (value === 0) return '0';
            // For values less than 1, show decimal places
            if (value > 0 && value < 1) {
                // For very small values, show more precision
                if (value < 0.01) {
                    return value.toFixed(4).replace('.', ',');
                }
                return value.toFixed(2).replace('.', ',');
            }
            // For values >= 1, round to the nearest integer and format with dots
            return Math.round(value).toLocaleString('de-DE');
        }

        // ==== FX convert (open.er-api.com) ====
        async function convertCurrency(){
            const amount = parseFloat(currencyInput.value.replace(/,/g, ''));
            console.log('Amount:', amount);
            const from=currencyFrom.value.toUpperCase();
            const to=currencyTo.value.toUpperCase();
            if(isNaN(amount)||amount<0){ currencyResult.textContent='Nhập số hợp lệ!'; return; }
            currencyResult.textContent='Đang tải tỷ giá...';
            currencyBtnText?.classList.add('hidden'); currencySpinner?.classList.remove('hidden'); convertCurrencyBtn.disabled=true;
            try{
            const res=await fetch(`https://open.er-api.com/v6/latest/${from}`);
            if(!res.ok) throw new Error(res.statusText);
            const data=await res.json();
            if(data.result==='success' && data.rates?.[to]!=null){
                const rate=data.rates[to];
                const result = amount * rate;
                //console.log(document.getElementById('amount').value);
                currencyResult.textContent = `${formatConverterResult(result)} ${to}`;
                currencyResult.parentElement.parentElement.title = `1 ${from} = ${rate.toLocaleString()} ${to}`;
            }else{ currencyResult.textContent='Lỗi API!'; showCustomAlert('Không lấy được tỷ giá hoặc không hỗ trợ đơn vị đích.'); }
            }catch(err){ currencyResult.textContent='Lỗi mạng!'; showCustomAlert('Không liên hệ được dịch vụ tỷ giá.'); }
            finally{ currencyBtnText?.classList.remove('hidden'); currencySpinner?.classList.add('hidden'); convertCurrencyBtn.disabled=false; }
        }

        // Weight
        function convertWeight(){
            const a=parseFloat(weightInput.value), f=weightFrom.value, t=weightTo.value;
            if(isNaN(a)||a<0){ weightResult.textContent='Nhập số hợp lệ!'; return; }
            let g=({lbs:a*453.592,kg:a*1000,g:a})[f];
            const r=({lbs:g/453.592,kg:g/1000,g:g})[t];
            weightResult.textContent=`${formatConverterResult(r)} ${t}`;
        }

        // Length
        function convertLength(){
            const a=parseFloat(lengthInput.value), f=lengthFrom.value, t=lengthTo.value;
            if(isNaN(a)||a<0){ lengthResult.textContent='Nhập số hợp lệ!'; return; }
            const toM={inch:.0254,cm:.01,m:1,km:1000,ft:.3048,yd:.9144,mi:1609.34};
            const m=a*toM[f]; const r=m/toM[t]; lengthResult.textContent=`${formatConverterResult(r)} ${t}`;
        }

        // Temp
        function convertTemperature(){
            const a=parseFloat(temperatureInput.value), f=temperatureFrom.value, t=temperatureTo.value;
            if(isNaN(a)){ temperatureResult.textContent='Nhập số hợp lệ!'; return; }
            const toK={F:(x)=>(x-32)*5/9+273.15, C:(x)=>x+273.15, K:(x)=>x}[f](a);
            const fromK={F:(k)=>(k-273.15)*9/5+32, C:(k)=>k-273.15, K:(k)=>k}[t](toK);
            temperatureResult.textContent=`${formatConverterResult(fromK)} ${t==='F'?'°F':t==='C'?'°C':'K'}`;
        }

        // Area
        function convertArea(){
            const a=parseFloat(areaInput.value), f=areaFrom.value, t=areaTo.value;
            if(isNaN(a)||a<0){ areaResult.textContent='Nhập số hợp lệ!'; return; }
            const toSqm={sqm:1,sqft:0.092903,sqkm:1_000_000,acre:4046.86,ha:10000};
            const sqm=a*toSqm[f]; const r=sqm/toSqm[t];
            const label={sqm:'m²',sqft:'ft²',sqkm:'km²',acre:'acre',ha:'ha'}[t];
            areaResult.textContent=`${formatConverterResult(r)} ${label}`;
        }

        // ===== Events =====
        openConverterBtn?.addEventListener('click', openPopup);
        closePopupBtn.addEventListener('click', closePopup);
        popupBackdrop.addEventListener('click', (e)=>{ if(e.target===popupBackdrop) closePopup(); });

        tabButtons.forEach(b=> b.addEventListener('click', e=> switchTab(e.target.dataset.tab)));

        document.querySelectorAll('.swap-icon').forEach(button => {
            button.addEventListener('click', (e) => {
                const container = e.target.parentElement;
                const selects = container.querySelectorAll('select');
                if (selects.length >= 2) {
                    const fromSelect = selects[0];
                    const toSelect = selects[1];
                    const fromValue = fromSelect.value;
                    fromSelect.value = toSelect.value;
                    toSelect.value = fromValue;
                    
                    // Trigger conversion based on the active tab
                    const activeTab = document.querySelector('.tab-content.active').id;
                    switch(activeTab) {
                        case 'currency': convertCurrency(); break;
                        case 'weight': convertWeight(); break;
                        case 'length': convertLength(); break;
                        case 'temperature': convertTemperature(); break;
                        case 'area': convertArea(); break;
                    }
                }
            });
        });

        convertCurrencyBtn.addEventListener('click', convertCurrency);
        currencyInput.addEventListener('input', convertCurrency);
        currencyFrom.addEventListener('change', convertCurrency);
        currencyTo.addEventListener('change', convertCurrency);
        currencyInput.addEventListener('keypress', e=>{ if(e.key==='Enter') convertCurrency(); });

        convertWeightBtn.addEventListener('click', convertWeight);
        weightInput.addEventListener('input', convertWeight);
        weightFrom.addEventListener('change', convertWeight);
        weightTo.addEventListener('change', convertWeight);
        weightInput.addEventListener('keypress', e=>{ if(e.key==='Enter') convertWeight(); });

        convertLengthBtn.addEventListener('click', convertLength);
        lengthInput.addEventListener('input', convertLength);
        lengthFrom.addEventListener('change', convertLength);
        lengthTo.addEventListener('change', convertLength);
        lengthInput.addEventListener('keypress', e=>{ if(e.key==='Enter') convertLength(); });

        convertTemperatureBtn.addEventListener('click', convertTemperature);
        temperatureInput.addEventListener('input', convertTemperature);
        temperatureFrom.addEventListener('change', convertTemperature);
        temperatureTo.addEventListener('change', convertTemperature);
        temperatureInput.addEventListener('keypress', e=>{ if(e.key==='Enter') convertTemperature(); });

        convertAreaBtn.addEventListener('click', convertArea);
        areaInput.addEventListener('input', convertArea);
        areaFrom.addEventListener('change', convertArea);
        areaTo.addEventListener('change', convertArea);
        areaInput.addEventListener('keypress', e=>{ if(e.key==='Enter') convertArea(); });

        // Init sau khi DOM sẵn
        window.addEventListener('load', async ()=>{
            popupBackdrop.classList.add('hidden');
            initialLoading.classList.add('hidden');
            // mở mặc định tab tiền tệ
            switchTab('currency');
            // set default & tính trước
            if(currencyInput){ currencyInput.value=1; await convertCurrency(); }
            if(weightInput){ weightInput.value=1; convertWeight(); }
            if(lengthInput){ lengthInput.value=1; convertLength(); }
            if(temperatureInput){ temperatureInput.value=32; convertTemperature(); }
            if(areaInput){ areaInput.value=1; convertArea(); }
        });
        const amountInputPro = document.getElementById('currencyInput');
        amountInputPro.addEventListener('input', function(e) {
            let val = this.value.replace(/[^0-9]/g, '');
            if(val) {
                this.value = Number(val).toLocaleString('en-US');
            } else {
                this.value = '';
            }
        });
    </script>
</body>

</html>


